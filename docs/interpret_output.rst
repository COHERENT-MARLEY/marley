=======================
Interpreting the output
=======================

PDG codes
_________

The `Particle Data Group <http://pdg.lbl.gov/index.html>`__ has defined a
standard numbering scheme for representing particle species in Monte Carlo
event generators. Each kind of particle is assigned a unique positive integer
as an identifier. The corresponding antiparticle is assigned a negative integer
with the same absolute value. A full description of the numbering scheme is
available `here <http://pdg.lbl.gov/current/mc-particle-id>`__. 

Like nearly all modern particle physics generators, MARLEY adopts the integer
*PDG codes* for particle identification and uses them both internally and in
output files. For convenience, a table of the PDG codes most relevant for
MARLEY is given below.

.. raw:: html
   
   <head>
     <style>
       table {
         border-collapse: separate;
         border-spacing: 0 5px;
       }
       th, td {
         text-align: center;
       }
     </style>
   </head>

   <table align="center" style="width:30%">

     <tr>
       <th>PDG code</th>
       <th>Particle</th>
     </tr>

     <tr>
       <td>11</td>
       <td>e<sup>&minus;</sup></td>
     </tr>

     <tr>
       <td>12</td>
       <td>&nu;<sub>e</sub></td>
     </tr>

     <tr>
       <td>13</td>
       <td>&mu;<sup>&minus;</sup></td>
     </tr>

     <tr>
       <td>14</td>
       <td>&nu;<sub>&mu;</sub></td>
     </tr>

     <tr>
       <td>15</td>
       <td>&tau;<sup>&minus;</sup></td>
     </tr>

     <tr>
       <td>16</td>
       <td>&nu;<sub>&tau;</sub></td>
     </tr>

     <tr>
       <td>22</td>
       <td>&gamma;</td>
     </tr>

     <tr>
       <td>2112</td>
       <td>n</td>
     </tr>

     <tr>
       <td>2212</td>
       <td>p</td>
     </tr>

     <tr>
       <td>1000010020</td>
       <td>d</td>
     </tr>

     <tr>
       <td>1000010030</td>
       <td>t</td>
     </tr>

     <tr>
       <td>1000020030</td>
       <td>h</td>
     </tr>


     <tr>
       <td>1000020040</td>
       <td>&alpha;</td>
     </tr>

  </table>

In general, a PDG code of the form 100ZZZAAA0 represents a nuclide with proton
number Z and mass number A. For example, :superscript:`40`\Ar is represented by
the PDG code 1000180400.

File formats
------------

The neutrino scattering events generated by the command-line executable may be
saved to disk in four distinct output formats. Descriptions of each of these
formats are given below.

ASCII
-----

The ASCII format is MARLEY's native text-based format for event input and
output. It is produced and parsed by applying the stream insertion (``<<``) and
extraction (``>>``) operators to the ``marley::Event`` class in the C++ source
code.

An ASCII-format output file begins with the line
::

  FluxAvgXSec

.. |InverseMeVSquaredPerAtom| raw:: html

   MeV<sup> &minus;2</sup>

where ``FluxAvgXSec`` is the flux-averaged total reaction cross section in
natural units (|InverseMeVSquaredPerAtom|). This quantity may be used together
with the events themselves to compute differential cross sections

.. todo::
   Cite paper

One or more event records appear in the remainder of the output file. Each
event record begins with a header of the form

::

  Ni Nf Ex twoJ P

where ``Ni`` (``Nf``) is the number of particles in the initial (final) state.
The three remaining fields in the event header report properties of the
final-state nucleus following the primary scattering reaction but before
de-excitations. The ``Ex`` field gives the nuclear excitation energy (MeV),
``twoJ`` gives the nuclear spin multiplied by two (to allow half-integer spins
to be represented by a C++ ``int``), and ``P`` is a single character
representing a positive (``+``) or negative (``-``) parity state.


Following the event header, each of the \texttt{Ni} initial-state particles is
described by a single line of the form
%\vspace{-1\baselineskip}
\begin{center}
\begin{tabular}{c}
\begin{lstlisting}[backgroundcolor=\color{white}, numbers=none]
PDG Etot Px Py Pz M Q
\end{lstlisting}
\end{tabular}
\end{center}
where \texttt{PDG} is the Particle Data Group code \cite[pp.
560--563]{PDGreview} identifying the particle species and \texttt{Etot},
\texttt{Px}, \texttt{Py}, and \texttt{Pz} are the Cartesian components of the
particle 4-momentum (in \si{\MeV}). The particle mass \texttt{M} (\si{MeV}) and
(net) electric charge \texttt{Q} (in units of the elementary charge) are also
included in each line. To complete the event record, \texttt{Nf} lines
describing the final-state particles appear in the same format used for the
initial-state particles.

\lstinputlisting[linewidth=\textwidth,caption={Example \ascii-format
output file},captionpos=b,label={lst:ascii_events},
basicstyle=\scriptsize\ttfamily]{example.ascii}

\Cref{lst:ascii_events} shows an example \marley\ output file in \ascii\
format. Line 1 gives the value of $\SI{5.984e-19}{\MeV\tothe{-2}} =
\SI{2.330e-40}{\centi\meter\squared}$ for the flux-averaged total cross
section. Line 2 begins the record for the first event, which involves a
transition to the \isotope[40]{K} nuclear level with an excitation energy of
\SI{3.797}{\MeV} above the ground state and spin-parity $1^+$. Lines 3--4
describe the initial state: a \SI{10}{\MeV} $\nu_e$ traveling in the $+z$
direction toward a \isotope[40]{Ar} atom at rest. Lines 5--8 describe the
final-state particles: a \SI{5.2}{\MeV} electron, the recoiling \isotope[40]{K}
ion, and two de-excitation $\gamma$-rays with energies of \num{1.54} and
\SI{2.26}{\MeV}. The second and final event in the file, which appears on lines
9--14, involves a $\nu_e$-\isotope[40]{Ar} collision which produces an
electron, a \isotope[39]{K} ion, and a neutron.






HEPEVT
------

JSON
----

ROOT
----
